(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8],{9925:function(e,t,r){Promise.resolve().then(r.bind(r,6907)),Promise.resolve().then(r.bind(r,8779))},7099:function(e,t,r){"use strict";r.d(t,{OL:function(){return h},_T:function(){return u},aR:function(){return c},f$:function(){return f},fY:function(){return m},le:function(){return v},xo:function(){return x},yT:function(){return p}});var i=r(7437),s=r(2265),n=r(277),a=r(4508),o=r(2869);let c=n.fC;n.xz;let l=n.h_,d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,i.jsx)(n.aV,{className:(0,a.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...s,ref:t})});d.displayName=n.aV.displayName;let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,i.jsxs)(l,{children:[(0,i.jsx)(d,{}),(0,i.jsx)(n.VY,{ref:t,className:(0,a.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...s})]})});u.displayName=n.VY.displayName;let m=e=>{let{className:t,...r}=e;return(0,i.jsx)("div",{className:(0,a.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...r})};m.displayName="AlertDialogHeader";let x=e=>{let{className:t,...r}=e;return(0,i.jsx)("div",{className:(0,a.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...r})};x.displayName="AlertDialogFooter";let f=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,i.jsx)(n.Dx,{ref:t,className:(0,a.cn)("text-lg font-semibold",r),...s})});f.displayName=n.Dx.displayName;let p=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,i.jsx)(n.dk,{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",r),...s})});p.displayName=n.dk.displayName;let h=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,i.jsx)(n.aU,{ref:t,className:(0,a.cn)((0,o.d)(),r),...s})});h.displayName=n.aU.displayName;let v=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,i.jsx)(n.$j,{ref:t,className:(0,a.cn)((0,o.d)({variant:"outline"}),"mt-2 sm:mt-0",r),...s})});v.displayName=n.$j.displayName},6818:function(e,t,r){"use strict";r.d(t,{g:function(){return a}});var i=r(7437),s=r(2265),n=r(4508);let a=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,i.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...s})});a.displayName="Textarea"},8779:function(e,t,r){"use strict";let i;r.d(t,{WorkoutForm:function(){return _}});var s=r(7437),n=r(2265),a=r(970),o=r(9376),c=r(6070),l=r(2869),d=r(5186),u=r(6815),m=r(6818),x=r(3647),f=r(5153),p=r(9397),h=r(7168);let v=(0,r(9763).Z)("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);var y=r(8930),g={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let j=new Uint8Array(16),N=[];for(let e=0;e<256;++e)N.push((e+256).toString(16).slice(1));var b=function(e,t,r){if(g.randomUUID&&!t&&!e)return g.randomUUID();let s=(e=e||{}).random||(e.rng||function(){if(!i&&!(i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(j)})();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=s[e];return t}return function(e,t=0){return N[e[t+0]]+N[e[t+1]]+N[e[t+2]]+N[e[t+3]]+"-"+N[e[t+4]]+N[e[t+5]]+"-"+N[e[t+6]]+N[e[t+7]]+"-"+N[e[t+8]]+N[e[t+9]]+"-"+N[e[t+10]]+N[e[t+11]]+N[e[t+12]]+N[e[t+13]]+N[e[t+14]]+N[e[t+15]]}(s)},w=r(7099);function _(e){let{trainerId:t,clients:r,exercises:i,preSelectedClientId:g,workout:j}=e,[N,_]=(0,n.useState)((null==j?void 0:j.title)||""),[E,k]=(0,n.useState)((null==j?void 0:j.description)||""),[S,z]=(0,n.useState)(g||(null==j?void 0:j.client_id)||""),[C,T]=(0,n.useState)([]),[I,O]=(0,n.useState)(!1),[R,U]=(0,n.useState)(!0),[D,F]=(0,n.useState)(null),[M,A]=(0,n.useState)(null),[P,V]=(0,n.useState)(!1),[L,Z]=(0,n.useState)(""),[W,q]=(0,n.useState)(!1),Y=(0,o.useRouter)(),$=(0,a.e)(),{toast:B}=(0,f.pm)();(0,n.useEffect)(()=>{let e=!0;return(async()=>{U(!0),F(null);try{if(!$)throw Error("Cliente Supabase n\xe3o inicializado");if((null==j?void 0:j.exercises)&&j.exercises.length>0){console.log("Inicializando exerc\xedcios existentes:",j.exercises.length);let t=j.exercises.map(e=>{let t=i.find(t=>t.id===e.exercise_id);return{...e,name:(null==t?void 0:t.name)||"Exerc\xedcio desconhecido"}});e&&T(t)}else console.log("Inicializando com array vazio de exerc\xedcios"),e&&T([])}catch(t){console.error("Erro ao inicializar exerc\xedcios:",t),e&&(F(t instanceof Error?t.message:"Erro ao inicializar exerc\xedcios"),B({title:"Erro ao carregar exerc\xedcios",description:"N\xe3o foi poss\xedvel carregar os exerc\xedcios da ficha. Tente novamente.",variant:"destructive"}))}finally{e&&U(!1)}})(),()=>{e=!1}},[j,B,i]);let H=()=>{let e={id:"temp-".concat(b()),exercise_id:"",sets:3,reps:12,rest_time:60,notes:"",order_index:C.length};T(t=>[...t,e])},Q=e=>{var t;let r=C.find(t=>t.id===e),s=(null==r?void 0:r.name)||(null===(t=i.find(e=>e.id===(null==r?void 0:r.exercise_id)))||void 0===t?void 0:t.name)||"este exerc\xedcio";A(e),Z(s),V(!0)},G=async()=>{if(M){q(!0);try{if(!M.startsWith("temp-")){console.log("Excluindo exerc\xedcio do banco de dados:",M);let e=await fetch("/api/workouts/exercises/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({exerciseId:M})});if(!e.ok){let t=await e.json();throw Error(t.error||"Erro ao excluir exerc\xedcio")}console.log("Exerc\xedcio exclu\xeddo com sucesso do banco de dados")}T(e=>e.filter(e=>e.id!==M)),B({title:"Exerc\xedcio removido",description:"O exerc\xedcio foi removido da ficha."})}catch(e){console.error("Erro ao excluir exerc\xedcio:",e),B({title:"Erro",description:e instanceof Error?e.message:"N\xe3o foi poss\xedvel excluir o exerc\xedcio. Tente novamente.",variant:"destructive"})}finally{A(null),V(!1),q(!1)}}},J=(e,t,r)=>{T(i=>i.map(i=>i.id===e?{...i,[t]:r}:i))},K=async e=>{if(e.preventDefault(),!N||!S||0===C.length){B({title:"Campos obrigat\xf3rios",description:"Preencha todos os campos obrigat\xf3rios e adicione pelo menos um exerc\xedcio.",variant:"destructive"});return}if(C.some(e=>!e.exercise_id)){B({title:"Exerc\xedcios inv\xe1lidos",description:"Selecione um exerc\xedcio para cada item da ficha.",variant:"destructive"});return}O(!0);try{if(!$)throw Error("Cliente Supabase n\xe3o inicializado");if(j){console.log("Atualizando ficha existente:",j.id),console.log("Total de exerc\xedcios a serem salvos:",C.length);try{let{error:e}=await $.from("workout_plans").update({title:N,description:E||null,updated_at:new Date().toISOString()}).eq("id",j.id);if(e)throw console.error("Erro ao atualizar ficha:",e),e;let t=C.filter(e=>e.id.startsWith("temp-")).map((e,t)=>({workout_plan_id:j.id,exercise_id:e.exercise_id,sets:e.sets,reps:e.reps,rest_time:e.rest_time||null,notes:e.notes||null,order_index:t})),r=C.filter(e=>!e.id.startsWith("temp-")).map((e,t)=>({id:e.id,exercise_id:e.exercise_id,sets:e.sets,reps:e.reps,rest_time:e.rest_time||null,notes:e.notes||null,order_index:t}));if(console.log("Exerc\xedcios para inserir: ".concat(t.length)),console.log("Exerc\xedcios para atualizar: ".concat(r.length)),t.length>0){let{error:e}=await $.from("workout_exercises").insert(t);if(e)throw console.error("Erro ao inserir novos exerc\xedcios:",e),e}for(let e of r){let{error:t}=await $.from("workout_exercises").update({exercise_id:e.exercise_id,sets:e.sets,reps:e.reps,rest_time:e.rest_time,notes:e.notes,order_index:e.order_index,updated_at:new Date().toISOString()}).eq("id",e.id);if(t)throw console.error("Erro ao atualizar exerc\xedcio ".concat(e.id,":"),t),t}}catch(e){throw console.error("Erro durante a atualiza\xe7\xe3o da ficha:",e),e}B({title:"Ficha atualizada",description:"A ficha de treino foi atualizada com sucesso."}),Y.push("/workouts/".concat(j.id))}else{let{data:e,error:r}=await $.from("workout_plans").insert({trainer_id:t,client_id:S,title:N,description:E||null}).select();if(r)throw r;let i=e[0].id,s=C.map((e,t)=>({workout_plan_id:i,exercise_id:e.exercise_id,sets:e.sets,reps:e.reps,rest_time:e.rest_time||null,notes:e.notes||null,order_index:t})),{error:n}=await $.from("workout_exercises").insert(s);if(n)throw n;B({title:"Ficha criada",description:"A ficha de treino foi criada com sucesso."}),Y.push("/workouts/".concat(i))}}catch(e){console.error("Erro ao salvar ficha:",e),B({title:"Erro",description:e instanceof Error?e.message:"N\xe3o foi poss\xedvel salvar a ficha de treino. Tente novamente.",variant:"destructive"})}finally{O(!1)}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("form",{onSubmit:K,children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)(c.Zb,{children:[(0,s.jsx)(c.Ol,{children:(0,s.jsx)(c.ll,{children:"Informa\xe7\xf5es B\xe1sicas"})}),(0,s.jsxs)(c.aY,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u._,{htmlFor:"title",children:"T\xedtulo da Ficha *"}),(0,s.jsx)(d.I,{id:"title",value:N,onChange:e=>_(e.target.value),placeholder:"Ex: Treino de Hipertrofia - Fase 1",required:!0})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u._,{htmlFor:"description",children:"Descri\xe7\xe3o"}),(0,s.jsx)(m.g,{id:"description",value:E,onChange:e=>k(e.target.value),placeholder:"Descreva o objetivo e instru\xe7\xf5es gerais desta ficha de treino",rows:3})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u._,{htmlFor:"client",children:"Aluno *"}),r.length>0?(0,s.jsxs)(x.Ph,{value:S,onValueChange:z,disabled:!!j||!!g,children:[(0,s.jsx)(x.i4,{id:"client",children:(0,s.jsx)(x.ki,{placeholder:"Selecione um aluno"})}),(0,s.jsx)(x.Bw,{children:r.map(e=>(0,s.jsx)(x.Ql,{value:e.id,children:e.name},e.id))})]}):(0,s.jsx)("div",{className:"text-sm text-muted-foreground p-2 border rounded-md",children:"Voc\xea ainda n\xe3o tem alunos. V\xe1 para a p\xe1gina de alunos para adicionar alunos ou aguarde que solicitem sess\xf5es com voc\xea."})]})]})]}),S&&(0,s.jsxs)(c.Zb,{children:[(0,s.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between",children:[(0,s.jsx)(c.ll,{children:"Exerc\xedcios"}),(0,s.jsxs)(l.z,{type:"button",onClick:H,variant:"outline",size:"sm",children:[(0,s.jsx)(p.Z,{className:"mr-2 h-4 w-4"}),"Adicionar Exerc\xedcio"]})]}),(0,s.jsx)(c.aY,{children:R?(0,s.jsx)("div",{className:"flex justify-center py-8",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):D?(0,s.jsxs)("div",{className:"text-center py-8 border rounded-md",children:[(0,s.jsxs)("p",{className:"text-red-500 mb-4",children:["Erro ao carregar exerc\xedcios: ",D]}),(0,s.jsxs)(l.z,{type:"button",variant:"outline",onClick:()=>{U(!0),F(null),window.location.reload()},children:[(0,s.jsx)(h.Z,{className:"mr-2 h-4 w-4"}),"Tentar novamente"]})]}):0===C.length?(0,s.jsxs)("div",{className:"text-center py-8 border rounded-md",children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Nenhum exerc\xedcio adicionado"}),(0,s.jsx)(l.z,{type:"button",onClick:H,variant:"link",className:"mt-2",children:"Adicionar Exerc\xedcio"})]}):(0,s.jsx)("div",{className:"space-y-4",children:C.map((e,t)=>(0,s.jsxs)("div",{className:"border rounded-md p-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(v,{className:"h-5 w-5 text-muted-foreground mr-2"}),(0,s.jsxs)("span",{className:"font-medium",children:["Exerc\xedcio ",t+1]})]}),(0,s.jsx)(l.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>Q(e.id),"aria-label":"Remover exerc\xedcio",children:(0,s.jsx)(y.Z,{className:"h-4 w-4 text-destructive"})})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u._,{htmlFor:"exercise-".concat(e.id),children:"Exerc\xedcio *"}),(0,s.jsxs)(x.Ph,{value:e.exercise_id,onValueChange:t=>{let r=i.find(e=>e.id===t);J(e.id,"exercise_id",t),r&&J(e.id,"name",r.name)},children:[(0,s.jsx)(x.i4,{id:"exercise-".concat(e.id),children:(0,s.jsx)(x.ki,{placeholder:"Selecione um exerc\xedcio"})}),(0,s.jsx)(x.Bw,{children:i.map(e=>(0,s.jsx)(x.Ql,{value:e.id,children:e.name},e.id))})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u._,{htmlFor:"sets-".concat(e.id),children:"S\xe9ries *"}),(0,s.jsx)(d.I,{id:"sets-".concat(e.id),type:"number",min:"1",value:e.sets,onChange:t=>J(e.id,"sets",Number.parseInt(t.target.value)||1),required:!0})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u._,{htmlFor:"reps-".concat(e.id),children:"Repeti\xe7\xf5es *"}),(0,s.jsx)(d.I,{id:"reps-".concat(e.id),type:"number",min:"1",value:e.reps,onChange:t=>J(e.id,"reps",Number.parseInt(t.target.value)||1),required:!0})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u._,{htmlFor:"rest-".concat(e.id),children:"Descanso (segundos)"}),(0,s.jsx)(d.I,{id:"rest-".concat(e.id),type:"number",min:"0",value:e.rest_time||"",onChange:t=>J(e.id,"rest_time",Number.parseInt(t.target.value)||null)})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u._,{htmlFor:"notes-".concat(e.id),children:"Observa\xe7\xf5es"}),(0,s.jsx)(d.I,{id:"notes-".concat(e.id),value:e.notes||"",onChange:t=>J(e.id,"notes",t.target.value),placeholder:"Ex: Controle a descida"})]})]})]},e.id))})}),(0,s.jsxs)(c.eW,{className:"flex justify-between",children:[(0,s.jsx)(l.z,{type:"button",variant:"outline",onClick:()=>Y.back(),children:"Cancelar"}),(0,s.jsx)(l.z,{type:"submit",disabled:I||0===C.length||R||!!D,children:I?"Salvando...":j?"Atualizar Ficha":"Criar Ficha"})]})]})]})}),(0,s.jsx)(w.aR,{open:P,onOpenChange:V,children:(0,s.jsxs)(w._T,{children:[(0,s.jsxs)(w.fY,{children:[(0,s.jsx)(w.f$,{children:"Confirmar exclus\xe3o"}),(0,s.jsxs)(w.yT,{children:["Tem certeza que deseja remover ",L," da ficha? Esta a\xe7\xe3o n\xe3o pode ser desfeita."]})]}),(0,s.jsxs)(w.xo,{children:[(0,s.jsx)(w.le,{disabled:W,children:"Cancelar"}),(0,s.jsx)(w.OL,{onClick:G,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",disabled:W,children:W?"Removendo...":"Remover"})]})]})})]})}},9397:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});let i=(0,r(9763).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},7168:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});let i=(0,r(9763).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},1599:function(e,t,r){"use strict";r.d(t,{z:function(){return a}});var i=r(2265),s=r(8575),n=r(1188),a=e=>{var t,r;let a,c;let{present:l,children:d}=e,u=function(e){var t,r;let[s,a]=i.useState(),c=i.useRef(null),l=i.useRef(e),d=i.useRef("none"),[u,m]=(t=e?"mounted":"unmounted",r={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},i.useReducer((e,t)=>{let i=r[e][t];return null!=i?i:e},t));return i.useEffect(()=>{let e=o(c.current);d.current="mounted"===u?e:"none"},[u]),(0,n.b)(()=>{let t=c.current,r=l.current;if(r!==e){let i=d.current,s=o(t);e?m("MOUNT"):"none"===s||(null==t?void 0:t.display)==="none"?m("UNMOUNT"):r&&i!==s?m("ANIMATION_OUT"):m("UNMOUNT"),l.current=e}},[e,m]),(0,n.b)(()=>{if(s){var e;let t;let r=null!==(e=s.ownerDocument.defaultView)&&void 0!==e?e:window,i=e=>{let i=o(c.current).includes(e.animationName);if(e.target===s&&i&&(m("ANIMATION_END"),!l.current)){let e=s.style.animationFillMode;s.style.animationFillMode="forwards",t=r.setTimeout(()=>{"forwards"===s.style.animationFillMode&&(s.style.animationFillMode=e)})}},n=e=>{e.target===s&&(d.current=o(c.current))};return s.addEventListener("animationstart",n),s.addEventListener("animationcancel",i),s.addEventListener("animationend",i),()=>{r.clearTimeout(t),s.removeEventListener("animationstart",n),s.removeEventListener("animationcancel",i),s.removeEventListener("animationend",i)}}m("ANIMATION_END")},[s,m]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:i.useCallback(e=>{c.current=e?getComputedStyle(e):null,a(e)},[])}}(l),m="function"==typeof d?d({present:u.isPresent}):i.Children.only(d),x=(0,s.e)(u.ref,(a=null===(t=Object.getOwnPropertyDescriptor(m.props,"ref"))||void 0===t?void 0:t.get)&&"isReactWarning"in a&&a.isReactWarning?m.ref:(a=null===(r=Object.getOwnPropertyDescriptor(m,"ref"))||void 0===r?void 0:r.get)&&"isReactWarning"in a&&a.isReactWarning?m.props.ref:m.props.ref||m.ref);return"function"==typeof d||u.isPresent?i.cloneElement(m,{ref:x}):null};function o(e){return(null==e?void 0:e.animationName)||"none"}a.displayName="Presence"}}]);